<!DOCTYPE html>
<html>
<head>
<title>Dashboard</title>
<a href="admin.html">
<button>Admin Panel</button>
  <a href="gallery.html">
<button>View Gallery</button>
</a>

</a>

<style>
<a href="admin.html">
<button>Admin Panel</button>
</a>

body{
  font-family: Arial;
  background:#111;
  color:white;
  padding:40px;
}

.container{
  max-width:700px;
  margin:auto;
}

.card{
  background:#1f1f1f;
  padding:25px;
  border-radius:10px;
  margin-top:20px;
}

button{
  padding:10px 20px;
  margin-top:15px;
  cursor:pointer;
}

.active{
  color:lime;
}

.expired{
  color:red;
}

</style>

<!-- AUTO AUTH GUARD -->
<script>

// must be logged in
if(localStorage.getItem("loggedIn") !== "true"){
  alert("Login required");
  window.location.href="login.html";
}

// must have subscription
let sub = JSON.parse(localStorage.getItem("subscription"));

if(!sub){
  alert("No active subscription");
  window.location.href="pricing.html";
}

// check expiry
let today = new Date();
let expiry = new Date(sub.expiry);
let sub = JSON.parse(localStorage.getItem("subscription"));

if(!sub){
  window.location.href="pricing.html";
}

let today = new Date();
let expiry = new Date(sub.expiry);

if(today > expiry){
  localStorage.removeItem("subscription");
  alert("Subscription expired. Renew.");
  window.location.href="pricing.html";
}

if(today > expiry){
  alert("Subscription expired");
  localStorage.removeItem("subscription");
  window.location.href="pricing.html";
}

</script>

</head>

<body>

<div class="container">

<h1>Member Dashboard</h1>

<div class="card">
<h3>User Info</h3>
<div id="userInfo"></div>
</div>

<div class="card">
<h3>Subscription Details</h3>
<div id="subscriptionInfo"></div>
</div>

<div class="card">
<h3>Member Access</h3>

<a href="gallery.html">
<button>View Gallery</button>
</a>

<a href="booking.html">
<button>Book Service</button>
</a>

<a href="admin.html">
<button>Admin Panel</button>
</a>

<button onclick="logout()">Logout</button>

</div>

</div>

<script>

// show username
let user = localStorage.getItem("username");
document.getElementById("userInfo").innerHTML = "Username: " + user;


// show subscription
let subscription = JSON.parse(localStorage.getItem("subscription"));

let today2 = new Date();
let expiry2 = new Date(subscription.expiry);

let status = today2 > expiry2
? "<span class='expired'>EXPIRED</span>"
: "<span class='active'>ACTIVE</span>";

document.getElementById("subscriptionInfo").innerHTML =
`
Plan: ${subscription.plan}<br>
Price: KSh ${subscription.price}<br>
Start: ${subscription.start}<br>
Expiry: ${subscription.expiry}<br>
Status: ${status}
`;


// logout
function logout(){
  localStorage.removeItem("loggedIn");
  localStorage.removeItem("username");
  window.location.href="login.html";
}

</script>

</body>
</html>

