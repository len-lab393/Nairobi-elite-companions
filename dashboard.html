<!DOCTYPE html>
<html>
<head>
<title>Member Dashboard</title>
<link rel="stylesheet" href="style.css">
<script>
let sub = JSON.parse(localStorage.getItem("subscription"));

if(!sub){
  alert("No active subscription");
  window.location.href = "pricing.html";
}
let sub = JSON.parse(localStorage.getItem("subscription"));

if(sub){
  let today = new Date();
  let expiry = new Date(sub.expiry);

  let daysLeft = Math.ceil((expiry - today)/(1000*60*60*24));

  if(daysLeft <= 2){
    alert("Your plan expires in " + daysLeft + " days");
  }
}

let today = new Date();
let expiry = new Date(sub.expiry);

if(today > expiry){
  alert("Your subscription has expired");

  localStorage.removeItem("subscription"); // auto unsubscribe
  window.location.href = "pricing.html";
}
</script>

<script>
// block access if not logged in
if(!localStorage.getItem("userEmail")){
window.location.href="login.html";
}
</script>

</head>

<body>
<h3>Your Subscription</h3>
<div id="subscriptionInfo"></div>

<script>
let sub = JSON.parse(localStorage.getItem("subscription"));

if(sub){
  document.getElementById("subscriptionInfo").innerHTML =
  `
  User: ${sub.user}<br>
  Plan: ${sub.plan}<br>
  Start: ${sub.start}<br>
  Expiry: ${sub.expiry}
  `;
}else{
  document.getElementById("subscriptionInfo").innerHTML = "No active plan";
}
</script>

  
<h2>Choose Your Plan</h2>

<h2>Choose Your Plan</h2>

<div class="plans">
  <button onclick="selectPlan('2 Days Plan', 100)">
    2 Days Plan - KSh 100
  </button>

  <button onclick="selectPlan('Weekly Plan', 400)">
    Weekly Plan - KSh 400
  </button>

  <button onclick="selectPlan('Monthly Plan', 1200)">
    Monthly Plan - KSh 1200
  </button>
</div>

<script>
function selectPlan(planName, price) {
  localStorage.setItem("selectedPlan", planName);
  localStorage.setItem("planPrice", price);

  alert("You selected " + planName + " - KSh " + price);

  // redirect to booking or payment page
  window.location.href = "booking.html";
}
</script>


<h3>Membership Status</h3>
<p id="status"></p>

<div id="renewBox"></div>


<br>

<a href="profiles.html">View VIP Profiles</a>
<br><br>

<button onclick="logout()">Logout</button>

<script>
  let expiry = localStorage.getItem("membershipExpiry");

if(Date.now() > expiry){
document.getElementById("status").innerText = "Expired ❌";
}
else{
document.getElementById("status").innerText = "Active ✅";
}

// show username
let username = localStorage.getItem("username");
document.getElementById("welcome").innerText = username;

// logout function
function logout(){
localStorage.clear();
window.location.href="login.html";
  <br>
<a href="booking.html">Make Booking</a>

</script>

</body>
</html>
